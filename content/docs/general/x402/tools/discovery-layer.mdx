---
title: "x402 Discovery Layer"
description: "A discovery API for finding and registering x402-enabled resources on Polygon"
---

The x402 Discovery Layer is a searchable registry of all x402-compatible APIs and services running on Polygon networks. It enables developers and AI agents to discover paywall-protected resources through a simple REST API.

**Base URL:** `https://x402-discovery.up.railway.app`

## How to Use

### Step 1: Search for APIs

Find x402-enabled resources by searching with keywords, filtering by provider, or selecting a specific facilitator.

```bash
# Search for weather APIs
curl "https://x402-discovery.up.railway.app/discovery/resources?q=weather"
```

**Response:**
```json
{
  "items": [
    {
      "resource": "https://api.weather.com/v1/current",
      "type": "http",
      "x402Version": 1,
      "lastUpdated": "2025-11-19T01:25:58.509Z",
      "metadata": {
        "provider": "WeatherData Inc",
        "description": "Real-time weather forecasts with AI-powered predictions",
        "keywords": ["weather", "forecast", "climate"],
        "url": "https://docs.weatherdata.io",
        "facilitator": "polygon"
      },
      "accepts": [
        {
          "asset": "USDC",
          "network": "polygon",
          "payTo": "0x1234567890123456789012345678901234567890",
          "maxAmountRequired": "5.00",
          "maxTimeoutSeconds": 86400,
          "scheme": "x402",
          "mimeType": "application/json",
          "resource": "https://api.weather.com/v1/current",
          "description": "Access real-time weather data",
          "outputSchema": {
            "input": {
              "type": "http",
              "method": "GET",
              "queryParams": {
                "location": {
                  "type": "string",
                  "required": true,
                  "description": "City name or coordinates"
                }
              }
            },
            "output": {
              "type": "object",
              "format": "json",
              "description": "Weather data response"
            }
          }
        }
      ]
    }
  ]
}
```

### Step 2: Review API Usage from Accepts Array

The `accepts` array contains everything you need to use the API:

- **Payment Requirements**: `asset`, `network`, `payTo`, `maxAmountRequired`, `maxTimeoutSeconds`
- **API Documentation**: `outputSchema` with complete `input` and `output` definitions
- **Method Details**: HTTP method, query parameters, body parameters, and their types
- **Response Format**: Expected output format and structure

The `outputSchema.input` field shows how to call the API:
- **method**: HTTP method (GET, POST, etc.)
- **queryParams**: Query string parameters and their types
- **bodyParams**: Request body parameters (for POST/PUT)
- **required**: Whether a parameter is mandatory

### Step 3: Get Fresh Payment Requirements (Optional)

While the Discovery Layer provides cached payment information in the `accepts` array, you can always fetch the latest requirements directly from the x402 endpoint:

```bash
# Fetch current payment details from the actual endpoint
curl "https://api.weather.com/v1/current"
```

**x402 Response (402 Payment Required):**
```json
{
  "x402Version": 1,
  "error": "X-PAYMENT header is required",
  "accepts": [
    {
      "scheme": "x402",
      "network": "polygon",
      "maxAmountRequired": "5.00",
      "payTo": "0x1234567890123456789012345678901234567890",
      "maxTimeoutSeconds": 86400,
      "asset": "USDC",
      "mimeType": "application/json",
      "resource": "https://api.weather.com/v1/current",
      "description": "Access real-time weather data",
      "outputSchema": {
        "input": {
          "type": "http",
          "method": "GET",
          "queryParams": {
            "location": {
              "type": "string",
              "required": true,
              "description": "City name or coordinates"
            }
          }
        }
      }
    }
  ]
}
```

**Why ping the endpoint?** Payment requirements can change dynamically (prices, recipient addresses, supported networks). The Discovery Layer provides a cached version, but for the most current data, query the source directly.

### Step 4: Integrate with Your App

Use the discovered resource URL with your x402 client to make payments and access the API.

**TypeScript Example:**
```typescript
// 1. Discover the API
const response = await fetch(
  "https://x402-discovery.up.railway.app/discovery/resources?q=weather"
);
const { items } = await response.json();
const weatherAPI = items[0];

// 2. Use the discovered resource
console.log("API Resource:", weatherAPI.resource);
console.log("Type:", weatherAPI.type);
console.log("Last Updated:", weatherAPI.lastUpdated);

// 3. Get payment requirements from the accepts array
const acceptsInfo = weatherAPI.accepts[0];
console.log("Payment Required:", acceptsInfo.maxAmountRequired, acceptsInfo.asset);
console.log("Pay To:", acceptsInfo.payTo);
console.log("Network:", acceptsInfo.network);

// 4. Understand API usage from outputSchema
const apiSchema = acceptsInfo.outputSchema;
console.log("HTTP Method:", apiSchema.input.method);
console.log("Parameters:", apiSchema.input.queryParams);

// 5. Make payment with x402 client and call API
// ... your x402 payment code here ...
```

### Step 5: Register Your API (Optional)

If you've built an x402-enabled service, register it to make it discoverable by others.

```bash
curl -X POST "https://x402-discovery.up.railway.app/discovery/resources" \
  -H "Content-Type: application/json" \
  -d '{
    "resource": "https://api.yourservice.com/v1/endpoint",
    "description": "Your service description",
    "provider": "Your Company Name",
    "facilitator": "polygon",
    "keywords": ["relevant", "keywords"],
    "url": "https://docs.yourservice.com",
    "x402Version": 1,
    "accepts": [
      {
        "asset": "USDC",
        "network": "polygon",
        "payTo": "0xYourPaymentAddress",
        "maxAmountRequired": "10.00",
        "maxTimeoutSeconds": 86400,
        "scheme": "x402",
        "mimeType": "application/json",
        "resource": "https://api.yourservice.com/v1/endpoint",
        "description": "Access to your API service",
        "outputSchema": {
          "input": {
            "type": "http",
            "method": "GET",
            "queryParams": {
              "param1": {
                "type": "string",
                "required": true,
                "description": "Parameter description"
              }
            }
          },
          "output": {
            "type": "object",
            "format": "json",
            "description": "Response description"
          }
        }
      }
    ]
  }'
```

**Success Response (201 Created):**
```json
{
  "message": "Resource registered successfully",
  "resource": {
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "resource": "https://api.yourservice.com/v1/endpoint",
    "description": "Your service description",
    "provider": "Your Company Name",
    "facilitator": "polygon",
    "keywords": ["relevant", "keywords"],
    "url": "https://docs.yourservice.com",
    "x402Version": 1,
    "accepts": [ ... ]
  }
}
```

## API Reference

### Discovering APIs

#### Search All Resources

```bash
curl "https://x402-discovery.up.railway.app/discovery/resources?limit=10"
```

#### Search by Keywords

```bash
curl "https://x402-discovery.up.railway.app/discovery/resources?q=weather"
```

Searches across descriptions, provider names, and keywords with PostgreSQL full-text search.

#### Filter by Provider

```bash
curl "https://x402-discovery.up.railway.app/discovery/resources?provider=DappLooker"
```

#### Filter by Facilitator

```bash
curl "https://x402-discovery.up.railway.app/discovery/resources?facilitator=thirdweb"
```

**Available facilitators:** `polygon`, `polygon-amoy`, `thirdweb`, `pay-ai`, `x402-rs`, `corbits`, `questflow`, `other`

#### Combine Filters

```bash
curl "https://x402-discovery.up.railway.app/discovery/resources?q=crypto&facilitator=polygon&limit=5"
```

### Response Format

All discovery endpoints return the Coinbase-compatible format:

```json
{
  "items": [
    {
      "accepts": [
        {
          "asset": "USDC",
          "network": "polygon",
          "payTo": "0x...",
          "maxAmountRequired": "10.00",
          "maxTimeoutSeconds": 86400,
          "scheme": "x402",
          "mimeType": "application/json",
          "resource": "https://api.example.com/v1/endpoint",
          "description": "API access description",
          "extra": {},
          "outputSchema": {
            "input": {
              "type": "http",
              "method": "GET",
              "queryParams": {},
              "bodyParams": {}
            },
            "output": {
              "type": "object",
              "format": "json",
              "description": "Response format"
            }
          }
        }
      ],
      "lastUpdated": "2025-11-19T01:25:58.509Z",
      "metadata": {
        "provider": "Provider Name",
        "description": "Service description",
        "keywords": ["keyword1", "keyword2"],
        "url": "https://docs.example.com",
        "facilitator": "polygon"
      },
      "resource": "https://api.example.com/v1/endpoint",
      "type": "http",
      "x402Version": 1
    }
  ]
}
```

### Registering Your API

#### Prepare Your Resource

```json
{
  "resource": "https://api.yourservice.com/v1/endpoint",
  "description": "Clear description of what your API does",
  "mimeType": "application/json",
  "provider": "Your Company Name",
  "facilitator": "polygon",
  "keywords": ["relevant", "searchable", "keywords"],
  "url": "https://docs.yourservice.com",
  "x402Version": 1,
  "accepts": [
    {
      "asset": "USDC",
      "network": "polygon",
      "payTo": "0xYourPaymentAddress",
      "maxAmountRequired": "10.00",
      "maxTimeoutSeconds": 86400,
      "scheme": "x402",
      "mimeType": "application/json",
      "resource": "https://api.yourservice.com/v1/endpoint",
      "description": "Access to your API service",
      "extra": {
        "additionalInfo": "any extra metadata"
      },
      "outputSchema": {
        "input": {
          "type": "http",
          "method": "GET",
          "queryParams": {
            "param1": {
              "type": "string",
              "required": true,
              "description": "Parameter description"
            },
            "param2": {
              "type": "number",
              "required": false,
              "description": "Optional parameter"
            }
          }
        },
        "output": {
          "type": "object",
          "format": "json",
          "description": "API response format",
          "fields": {
            "result": {
              "type": "string",
              "description": "Result field"
            }
          }
        }
      }
    }
  ]
}
```

**Key fields:**
- `resource` - Your x402 API endpoint URL (must be unique and return 402 responses)
- `description` - Clear description of what your API does
- `provider` - Your company or service name
- `facilitator` - Which facilitator you use (see list above)
- `keywords` - Array of searchable keywords
- `url` - Documentation URL for your API
- `x402Version` - x402 protocol version (currently 1)
- `accepts` - Array of payment acceptance configurations, each containing:
  - **Payment Info**: `asset`, `network`, `payTo`, `maxAmountRequired`, `maxTimeoutSeconds`
  - **API Info**: `scheme`, `mimeType`, `resource`, `description`
  - **Documentation**: `outputSchema` with complete input/output definitions
  - **Extra Metadata**: `extra` object for any additional information

**OutputSchema format for POST APIs:**
```json
{
  "outputSchema": {
    "input": {
      "type": "http",
      "method": "POST",
      "bodyParams": {
        "data": {
          "type": "string",
          "required": true,
          "description": "Input data"
        }
      },
      "bodyFields": {
        "nested": {
          "type": "object",
          "required": false,
          "description": "Nested object structure"
        }
      }
    },
    "output": {
      "type": "object",
      "format": "json",
      "description": "Response format",
      "fields": {
        "status": {
          "type": "string",
          "description": "Operation status"
        },
        "data": {
          "type": "object",
          "description": "Response data"
        }
      }
    }
  }
}
```

#### Register Your Resource

```bash
curl -X POST "https://x402-discovery.up.railway.app/discovery/resources" \
  -H "Content-Type: application/json" \
  -d '{
    "resource": "https://api.yourservice.com/v1/endpoint",
    "description": "Your service description",
    "provider": "Your Company Name",
    "facilitator": "polygon",
    "keywords": ["relevant", "keywords"],
    "url": "https://docs.yourservice.com",
    "x402Version": 1,
    "accepts": [
      {
        "asset": "USDC",
        "network": "polygon",
        "payTo": "0xYourAddress",
        "maxAmountRequired": "10.00",
        "maxTimeoutSeconds": 86400,
        "scheme": "x402",
        "mimeType": "application/json",
        "resource": "https://api.yourservice.com/v1/endpoint",
        "description": "API access",
        "outputSchema": {
          "input": {
            "type": "http",
            "method": "GET",
            "queryParams": {
              "id": {
                "type": "string",
                "required": true,
                "description": "Resource identifier"
              }
            }
          }
        }
      }
    ]
  }'
```

### Pagination

```bash
# Get first page (results 0-19)
curl "https://x402-discovery.up.railway.app/discovery/resources?limit=20&offset=0"

# Get second page (results 20-39)
curl "https://x402-discovery.up.railway.app/discovery/resources?limit=20&offset=20"
```

## Developer Workflow

1. **Discover APIs** - Search the Discovery Layer for relevant x402 endpoints
2. **Read Accepts Array** - Get payment requirements and API documentation from the `accepts` field
3. **Understand API** - Review `outputSchema` for complete API usage instructions
4. **Make Payment** - Use x402 client to create and send payment
5. **Call API** - Access the API with payment proof in headers

## Next Steps

- [x402 Protocol Guide](/general/x402/guides/introduction) - Learn more about x402
- [Build an x402 API](/general/x402/guides/providers/custom-resource) - Create your own x402-enabled service